<%# path = File.join Rails.root, 'public', 'yslowresult.txt' %>
<%# file = File.read(path) %>
<%# file.gsub!("\n","") %>

<%# data = JSON.parse(file) %>

<% data = { ruleset_applied: 
   { id: 'ydefault',
     name: 'YSlow(V2)',
     rules: 
      { ynumreq: {},
        ycdn: {},
        yemptysrc: {},
        yexpires: {},
        ycompress: {},
        ycsstop: {},
        yjsbottom: {},
        yexpressions: {},
        yexternal: {},
        ydns: {},
        yminify: {},
        yredirects: {},
        ydupes: {},
        yetags: {},
        yxhr: {},
        yxhrmethod: {},
        ymindom: {},
        yno404: {},
        ymincookie: {},
        ycookiefree: {},
        ynofilter: {},
        yimgnoscale: {},
        yfavicon: {} },
     weights: 
      { ynumreq: 8,
        ycdn: 6,
        yemptysrc: 30,
        yexpires: 10,
        ycompress: 8,
        ycsstop: 4,
        yjsbottom: 4,
        yexpressions: 3,
        yexternal: 4,
        ydns: 3,
        yminify: 4,
        yredirects: 4,
        ydupes: 4,
        yetags: 2,
        yxhr: 4,
        yxhrmethod: 3,
        ymindom: 3,
        yno404: 4,
        ymincookie: 3,
        ycookiefree: 3,
        ynofilter: 4,
        yimgnoscale: 3,
        yfavicon: 2 } },
  overall_score: 82.33613445378151,
  results: 
   [ { score: 56,
       message: 'This page has 7 external Javascript scripts.  Try combining them into one.\nThis page has 9 external stylesheets.  Try combining them into one.',
       components: [],
       weight: 8,
       name: 'Make fewer HTTP requests',
       category: [Array],
       rule_id: 'ynumreq' },
     { score: 0,
       message: 'There are 19 static components that are not on CDN. <p>You can specify CDN hostnames in your preferences. See <a href="javascript:document.ysview.openLink(\'http://developer.yahoo.com/yslow/faq.html#faq_cdn\')">YSlow FAQ</a> for details.</p>',
       components: [Array],
       weight: 6,
       name: 'Use a Content Delivery Network (CDN)',
       category: [Array],
       rule_id: 'ycdn' },
     { score: 100,
       message: '',
       components: [],
       weight: 30,
       name: 'Avoid empty src or href',
       category: [Array],
       rule_id: 'yemptysrc' },
     { score: 0,
       message: 'There are 20 static components without a far-future expiration date.',
       components: [Array],
       weight: 10,
       name: 'Add Expires headers',
       category: [Array],
       rule_id: 'yexpires' },
     { score: 100,
       message: '',
       components: [],
       weight: 8,
       name: 'Compress components with gzip',
       category: [Array],
       rule_id: 'ycompress' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Put CSS at top',
       category: [Array],
       rule_id: 'ycsstop' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Put JavaScript at bottom',
       category: [Array],
       rule_id: 'yjsbottom' },
     { score: 100,
       message: '',
       components: [],
       weight: 3,
       name: 'Avoid CSS expressions',
       category: [Array],
       rule_id: 'yexpressions' },
     { score: 'n/a',
       message: 'Only consider this if your property is a common user home page.',
       components: [Array],
       weight: 4,
       name: 'Make JavaScript and CSS external',
       category: [Array],
       rule_id: 'yexternal' },
     { score: 95,
       message: 'The components are split over more than 4 domains',
       components: [Array],
       weight: 3,
       name: 'Reduce DNS lookups',
       category: [Array],
       rule_id: 'ydns' },
     { score: 80,
       message: 'There are 2 components that can be minified',
       components: [Array],
       weight: 4,
       name: 'Minify JavaScript and CSS',
       category: [Array],
       rule_id: 'yminify' },
     { score: 90,
       message: 'There is 1 redirect',
       components: [Array],
       weight: 4,
       name: 'Avoid URL redirects',
       category: [Array],
       rule_id: 'yredirects' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Remove duplicate JavaScript and CSS',
       category: [Array],
       rule_id: 'ydupes' },
     { score: 100,
       message: '',
       components: [],
       weight: 2,
       name: 'Configure entity tags (ETags)',
       category: [Array],
       rule_id: 'yetags' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Make AJAX cacheable',
       category: [Array],
       rule_id: 'yxhr' },
     { score: 100,
       message: '',
       components: [],
       weight: 3,
       name: 'Use GET for AJAX requests',
       category: [Array],
       rule_id: 'yxhrmethod' },
     { score: 100,
       message: '',
       components: [],
       weight: 3,
       name: 'Reduce the number of DOM elements',
       category: [Array],
       rule_id: 'ymindom' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Avoid HTTP 404 (Not Found) error',
       category: [Array],
       rule_id: 'yno404' },
     { score: 100,
       message: '',
       components: [],
       weight: 3,
       name: 'Reduce cookie size',
       category: [Array],
       rule_id: 'ymincookie' },
     { score: 95,
       message: 'There is 1 component that is not cookie-free',
       components: [Array],
       weight: 3,
       name: 'Use cookie-free domains',
       category: [Array],
       rule_id: 'ycookiefree' },
     { score: 100,
       message: '',
       components: [],
       weight: 4,
       name: 'Avoid AlphaImageLoader filter',
       category: [Array],
       rule_id: 'ynofilter' },
     { score: 100,
       message: '',
       components: [],
       weight: 3,
       name: 'Do not scale images in HTML',
       category: [Array],
       rule_id: 'yimgnoscale' },
     { score: 100,
       message: '',
       components: [],
       weight: 2,
       name: 'Make favicon small and cacheable',
       category: [Array],
       rule_id: 'yfavicon' } ],
  url: 'http://adgoi.com/' }

%>

<h2>YSlow Score : <%= data[:overall_score] %></h2>
<ol>
<% data[:results].each do |result| %>
	<li><%= result[:name] %></li>
	<ul>
		<li> Score :  <%= result[:score] %></li>
		<li> Weight : <%= result[:weight] %></li>
		<%= "<li> Message : #{result[:message]}</li>".html_safe if result[:message]!='' %>
		<li> Components : <%= result[:components] %></li>
	</ul>
<% end %>
</ol>
